var wpDataTablesChartJS=function(){var t={container:"#chart-js-container",canvas:"#chart-js-canvas",columnIndexes:[],connectedWPDataTable:null,renderCallback:null,chart:null,pieCharts:["chartjs_polar_area_chart","chartjs_pie_chart","chartjs_doughnut_chart"],setContainer:function(t){this.container=t},setCanvas:function(t){this.canvas=t},setContainerOptions:function(t){0==t.container.width?this.container.style.width=null:this.container.style.width=t.container.width+"px",this.container.style.height=t.container.height+"px",this.canvas.style.backgroundColor=t.canvas.backgroundColor,this.canvas.style.border=t.canvas.borderWidth+"px solid "+t.canvas.borderColor,this.canvas.style.borderRadius=t.canvas.borderRadius+"px"},setRenderCallback:function(t){this.renderCallback=t},globalOptions:{},options:{data:{},options:{scales:{xAxes:[{scaleLabel:{display:!0}}],yAxes:[{scaleLabel:{display:!0},ticks:{beginAtZero:!0}}]},title:{text:"",display:!0,position:"top",fontSize:16,fontColor:"#666"},legend:{display:!0,labels:{fontColor:"#666",fontSize:12,boxWidth:40}},tooltips:{enabled:!0,mode:"single",backgroundColor:"rgba(0,0,0,0.8)",titleFontSize:12,titleFontStyle:"bold",titleFontColor:"#fff",bodyFontSize:12,bodyFontStyle:"normal",caretSize:5,cornerRadius:6},maintainAspectRatio:!1}},setOptions:function(t){for(var o in t)for(var s in t[o])s&&(this.options.options[o][s]=t[o][s])},setGlobalOptions:function(t){for(var o in t)t[o]&&(this.globalOptions[o]=t[o])},setData:function(t){for(var o in t)this.options.data[o]=t[o]},getOptions:function(){return this.options},render:function(){for(var t in null!==this.renderCallback&&this.renderCallback(this),this.globalOptions)Chart.defaults.global[t]=this.globalOptions[t];this.chart=new Chart(this.canvas,this.options)},setType:function(t){switch(t){case"chartjs_line_chart":Chart.defaults.global.elements.line.fill=!1,this.options.type="line";break;case"chartjs_area_chart":Chart.defaults.global.elements.line.fill=!0,this.options.type="line";break;case"chartjs_stacked_area_chart":Chart.defaults.global.elements.line.fill=!0,this.options.type="line",this.options.options.scales.yAxes[0].stacked=!0;break;case"chartjs_column_chart":Chart.defaults.global.elements.line.fill=!0,this.options.type="bar";break;case"chartjs_radar_chart":Chart.defaults.global.elements.line.fill=!0,this.options.type="radar";break;case"chartjs_polar_area_chart":this.options.type="polarArea";break;case"chartjs_pie_chart":this.options.type="pie";break;case"chartjs_doughnut_chart":this.options.type="doughnut";break;case"chartjs_bubble_chart":this.options.type="bubble"}},setColumnIndexes:function(t){this.columnIndexes=t},setConnectedWPDataTable:function(t){this.connectedWPDataTable=t},setGrouping:function(t){this.group_chart=t},setChartConfig:function(t){if(1==t.responsive_width?this.container.style.width=null:(this.container.style.width=t.width+"px",this.options.options.maintainAspectRatio=!1),t.height&&(this.container.style.height=t.height+"px"),this.canvas.style.backgroundColor=t.background_color,this.canvas.style.border=t.border_width+"px solid "+t.border_color,t.border_radius&&(this.canvas.style.borderRadius=t.border_radius+"px"),t.font_size&&(this.globalOptions.defaultFontSize=t.font_size),t.font_name&&(this.globalOptions.defaultFontFamily=t.font_name),t.font_style&&(this.globalOptions.defaultFontStyle=t.font_style),!t.font_color||(this.globalOptions.defaultFontColor=t.font_color),-1==this.pieCharts.indexOf(t.chart_type)&&"chartjs_bubble_chart"!=t.chart_type){var o=0;for(var s in t.series_data)this.options.data.datasets[o].label=t.series_data[s].label,t.series_data[s].color&&(this.options.data.datasets[o].borderColor=t.series_data[s].color),t.series_data[s].color&&(this.options.data.datasets[o].backgroundColor="rgba("+hexToRgb(t.series_data[s].color).r+", "+hexToRgb(t.series_data[s].color).g+", "+hexToRgb(t.series_data[s].color).b+", 0.2)"),o++;if(1==t.curve_type)for(s in this.options.data.datasets)this.options.data.datasets[s].lineTension=.4;else for(s in this.options.data.datasets)this.options.data.datasets[s].lineTension=0}0==t.show_grid?(this.options.options.scales.xAxes[0].display=!1,this.options.options.scales.yAxes[0].display=!1):(this.options.options.scales.xAxes[0].display=!0,this.options.options.scales.yAxes[0].display=!0),t.horizontal_axis_label&&(this.options.options.scales.xAxes[0].scaleLabel.labelString=t.horizontal_axis_label),t.vertical_axis_label&&(this.options.options.scales.yAxes[0].scaleLabel.labelString=t.vertical_axis_label),""!=t.vertical_axis_min?this.options.options.scales.yAxes[0].ticks.min=parseInt(t.vertical_axis_min):this.options.options.scales.yAxes[0].ticks.beginAtZero=delete this.options.options.scales.yAxes[0].ticks.min,""!=t.vertical_axis_max?this.options.options.scales.yAxes[0].ticks.max=parseInt(t.vertical_axis_max):delete this.options.options.scales.yAxes[0].ticks.max,1==t.show_title?(this.options.options.title.display=!0,this.options.options.title.text=t.chart_title):this.options.options.title.display=!1,t.title_position&&(this.options.options.title.position=t.title_position),t.title_font_name&&(this.options.options.title.fontFamily=t.title_font_name),t.title_font_style&&(this.options.options.title.fontStyle=t.title_font_style),t.title_font_color?this.options.options.title.fontColor=t.title_font_color:this.options.options.title.fontColor="#666",1==t.tooltip_enabled?this.options.options.tooltips.enabled=!0:this.options.options.tooltips.enabled=!1,t.tooltip_background_color?this.options.options.tooltips.backgroundColor=t.tooltip_background_color:this.options.options.tooltips.backgroundColor="rgba(0,0,0,0.8)",t.tooltip_border_radius&&(this.options.options.tooltips.cornerRadius=parseInt(t.tooltip_border_radius)),1==t.tooltip_shared?this.options.options.tooltips.mode="label":this.options.options.tooltips.mode="single",1==t.show_legend?this.options.options.legend.display=!0:this.options.options.legend.display=!1,t.legend_position_cjs&&(this.options.options.legend.position=t.legend_position_cjs)},enableFollowFiltering:function(){null!=this.connectedWPDataTable&&(this.numberFormat=jQuery.parseJSON(jQuery("#"+this.connectedWPDataTable.data("described-by")).val()).number_format,this.connectedWPDataTable.fnSettings().aoDrawCallback.push({sName:"chart_filter_follow",fn:function(o){t.options.data.labels=[];var s=[],i=0,a=t.connectedWPDataTable._("tr",{filter:"applied"}).toArray();for(var e in t.columnIndexes){var n=[];if(t.columnIndexes.length>0&&0==e){for(var l in a)t.options.data.labels.push(a[l][t.columnIndexes[e]]);s=t.options.data.labels}else{for(var l in a){var r=a[l][t.columnIndexes[e]];1==t.numberFormat?n.push(parseFloat(wdtUnformatNumber(r,".",",",!0))):n.push(parseFloat(wdtUnformatNumber(r,",",".",!0)))}if(1==t.group_chart){var p=[],c=[];for(var l in s)if(void 0!==p&&p.length>0){var h="none";for(var e in p)"none"===h&&p[e]==s[l]&&(h=e);"none"===h?(p.push(s[l]),c.push(n[l])):c[h]+=n[l]}else p.push(s[l]),c.push(n[l]);t.options.data.labels=p,n=c}t.options.data.datasets[i].data=n,i++}}null!==t.chart&&t.chart.destroy(),null!==t.renderCallback&&t.renderCallback(t),t.chart=new Chart(t.canvas,t.options)}}))}};return t};